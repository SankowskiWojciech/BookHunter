DROP TABLE USER_LIBRARY;
DROP TABLE BOOK_AUTHOR_RELATIONS;
DROP TABLE USER_AUTHENTICATION;
DROP TABLE AUTHOR;
DROP TABLE BOOK;
DROP TABLE BOOK_RATING;

CREATE TABLE USER_AUTHENTICATION(
    USER_NAME VARCHAR(20) PRIMARY KEY NOT NULL UNIQUE,
    PASSWORD VARCHAR(60) NOT NULL,
    EMAIL_ADDRESS VARCHAR(30) NOT NULL UNIQUE
);

CREATE TABLE BOOK_RATING (
    ID VARCHAR(13) PRIMARY KEY NOT NULL,
    RATE_ONE INT,
    RATE_TWO INT,
    RATE_THREE INT,
    RATE_FOUR INT,
    RATE_FIVE INT
);

CREATE TABLE AUTHOR(
    ID BIGINT PRIMARY KEY NOT NULL UNIQUE,
    NAME VARCHAR(15) NOT NULL,
    SURNAME VARCHAR(20) NOT NULL,
    BIRTH_YEAR VARCHAR(4),
    DEATH_YEAR VARCHAR(4),
    PROFILE_PHOTO BYTEA,
    DESCRIPTION VARCHAR(5000),
    CATEGORIES VARCHAR
);

CREATE TABLE BOOK(
    ISBN VARCHAR(13) PRIMARY KEY NOT NULL UNIQUE,
    TITLE VARCHAR NOT NULL,
    ORIGINAL_TITLE VARCHAR,
    RELEASE_YEAR VARCHAR(4) NOT NULL,
    CATEGORIES VARCHAR,
    DESCRIPTION VARCHAR(5000),
    COUNTRY_CODE VARCHAR NOT NULL,
    COVER_IMAGE BYTEA,
    RATING VARCHAR(13) REFERENCES BOOK_RATING(ID)
);

CREATE TABLE BOOK_AUTHOR_RELATIONS(
    ID BIGINT PRIMARY KEY NOT NULL UNIQUE,
    BOOK_ID VARCHAR(13) NOT NULL REFERENCES BOOK(ISBN),
    AUTHOR_ID BIGINT NOT NULL REFERENCES AUTHOR(ID)
);

CREATE TABLE USER_LIBRARY(
    ID BIGINT PRIMARY KEY NOT NULL UNIQUE,
    USER_ID VARCHAR(20) NOT NULL REFERENCES USER_AUTHENTICATION(USER_NAME),
    RECENTLY_VIEWED VARCHAR NOT NULL
);